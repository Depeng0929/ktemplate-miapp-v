小程序分包策略

## 分包加载

1. 迁移到其他分包，修改内部跳转路径
2. 原有的页面保留，但是掏空内部作为“过渡页”，在onLoad是重定向到新的页面，这样虽然老页面没有迁移，但内容基本都是空的，体积很小。同时基于渠道来源，通知业务方逐步修改路径，直到某一天“过渡页”的访问量降低0并持续一段时间的，在删除“过渡页”。

## 资源CDN化

我们把除iconfront和比较重要的图片外都放到了CDN，大多数这些图片在首屏加载中都不会被使用到。

## 页面外置
一种是前面已经提到的把页面放到其他分包，另一种是页面H5化，H5页面通过webView来加载。在小程序中的H5体验流畅度上并不差，只是初试加载的时候比较慢，非核心页面可以考虑迁移为H5。

## 数据外置

有时候还有一部分数据不基本不变更的，没有通过接口下发，而是放在小程序代码包中，比如门店支持的城市数据等等。这些数据可以通过小程序的“数据预拉取”功能页放在CDN，在小程序冷启动的时候通过微信后台提前拉取。

```js
wx.getBackgroundFetchData

wx.setBackgroundFetchToken
```

## 分包异步化

使用“分包异步化”+“占位组件”的方式来把组件迁移出主包，放在分包中，在分包加载出来之前可以先展示占位组件，对用户的影响也比较小。
